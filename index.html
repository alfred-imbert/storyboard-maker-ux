<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Storyboard Maker ‚Äî UX Flow</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Helvetica, Arial, sans-serif;
            background: #fff;
            color: #111;
            line-height: 1.5;
        }

        /* App shell */
        .app {
            max-width: 900px;
            margin: 0 auto;
            min-height: 100vh;
        }

        /* Header */
        .app-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 16px 24px;
            border-bottom: 1px solid #e5e5e5;
        }
        .logo { font-weight: 700; font-size: 16px; }
        .logo span { color: #888; font-weight: 400; }
        .header-right { display: flex; gap: 12px; align-items: center; }
        .avatar {
            width: 28px; height: 28px; border-radius: 50%;
            background: #111; color: #fff; display: flex;
            align-items: center; justify-content: center;
            font-size: 12px; font-weight: 600;
        }

        /* Screens */
        .screen { display: none; padding: 32px 24px; }
        .screen.active { display: block; }

        /* Progress */
        .progress-bar {
            display: flex; align-items: center; gap: 0;
            padding: 24px 24px 0;
        }
        .step-dot {
            width: 32px; height: 32px; border-radius: 50%;
            border: 2px solid #ddd; background: #fff;
            display: flex; align-items: center; justify-content: center;
            font-size: 13px; font-weight: 600; color: #aaa;
            flex-shrink: 0; transition: all 0.3s;
        }
        .step-dot.active { border-color: #111; color: #111; }
        .step-dot.done { border-color: #111; background: #111; color: #fff; }
        .step-line { flex: 1; height: 2px; background: #ddd; transition: background 0.3s; }
        .step-line.done { background: #111; }
        .step-labels {
            display: flex; justify-content: space-between;
            padding: 8px 24px 0; margin-bottom: 8px;
        }
        .step-label {
            font-size: 11px; color: #aaa; text-align: center;
            width: 25%; transition: color 0.3s;
        }
        .step-label.active { color: #111; font-weight: 600; }
        .step-label.done { color: #666; }

        /* Typography */
        h1 { font-size: 24px; font-weight: 700; margin-bottom: 8px; }
        h2 { font-size: 18px; font-weight: 600; margin-bottom: 16px; }
        .subtitle { color: #666; font-size: 14px; margin-bottom: 32px; }

        /* Template cards */
        .template-grid {
            display: grid; grid-template-columns: repeat(auto-fill, minmax(140px, 1fr));
            gap: 12px; margin-bottom: 32px;
        }
        .template-card {
            border: 2px solid #e5e5e5; border-radius: 12px;
            padding: 20px 12px; text-align: center; cursor: pointer;
            transition: all 0.15s;
        }
        .template-card:hover { border-color: #111; }
        .template-card.selected { border-color: #111; background: #f5f5f5; }
        .template-icon { font-size: 28px; margin-bottom: 8px; }
        .template-name { font-size: 13px; font-weight: 600; }
        .template-sub { font-size: 11px; color: #888; margin-top: 2px; }

        /* Form */
        .form-group { margin-bottom: 20px; }
        label { display: block; font-size: 13px; font-weight: 600; margin-bottom: 6px; }
        input[type="text"], textarea, select {
            width: 100%; border: 1px solid #ddd; border-radius: 8px;
            padding: 10px 12px; font-size: 14px; font-family: inherit;
            background: #fff; color: #111; outline: none;
            transition: border-color 0.15s;
        }
        input:focus, textarea:focus, select:focus { border-color: #111; }
        textarea { min-height: 100px; resize: vertical; }
        .hint { font-size: 12px; color: #999; margin-top: 4px; }

        /* Layout grid */
        .two-col { display: grid; grid-template-columns: 1.5fr 1fr; gap: 32px; }
        @media (max-width: 640px) { .two-col { grid-template-columns: 1fr; } }

        /* Character/location rows */
        .entity-list { display: flex; flex-direction: column; gap: 8px; margin-bottom: 12px; }
        .entity-row {
            display: flex; align-items: center; gap: 10px;
            padding: 10px 12px; background: #f9f9f9; border-radius: 8px;
            border: 1px solid #eee;
        }
        .entity-avatar {
            width: 36px; height: 36px; border-radius: 50%;
            background: #eee; display: flex; align-items: center;
            justify-content: center; font-size: 18px; flex-shrink: 0;
        }
        .entity-avatar.has-img { background: #ddd; }
        .entity-name { font-size: 13px; font-weight: 600; }
        .entity-role { font-size: 12px; color: #888; }
        .entity-remove {
            margin-left: auto; background: none; border: none;
            cursor: pointer; font-size: 16px; color: #ccc; padding: 4px;
        }
        .entity-remove:hover { color: #111; }

        /* Upload zone */
        .upload-zone {
            border: 2px dashed #ddd; border-radius: 10px;
            padding: 24px; text-align: center; color: #999;
            font-size: 13px; cursor: pointer; transition: all 0.15s;
        }
        .upload-zone:hover { border-color: #111; color: #666; }

        /* Buttons */
        .btn {
            display: inline-flex; align-items: center; justify-content: center; gap: 6px;
            padding: 10px 20px; border-radius: 8px; font-size: 14px;
            font-weight: 600; border: none; cursor: pointer;
            font-family: inherit; transition: all 0.15s;
        }
        .btn-primary { background: #111; color: #fff; }
        .btn-primary:hover { background: #333; }
        .btn-secondary { background: #fff; color: #111; border: 1px solid #ddd; }
        .btn-secondary:hover { border-color: #111; }
        .btn-large { padding: 14px 32px; font-size: 15px; border-radius: 10px; }
        .btn-sm { padding: 6px 12px; font-size: 12px; }
        .btn-block { width: 100%; }

        .btn-row { display: flex; gap: 10px; justify-content: space-between; align-items: center; margin-top: 32px; }

        /* Scene cards */
        .scene-list { display: flex; flex-direction: column; gap: 12px; }
        .scene-card {
            display: flex; gap: 16px; padding: 16px;
            border: 1px solid #e5e5e5; border-radius: 12px;
            align-items: flex-start; transition: border-color 0.15s;
        }
        .scene-card:hover { border-color: #ccc; }
        .scene-thumb {
            width: 180px; height: 100px; border-radius: 8px;
            background: #f0f0f0; flex-shrink: 0; display: flex;
            align-items: center; justify-content: center;
            overflow: hidden; position: relative;
        }
        .scene-thumb img {
            width: 100%; height: 100%; object-fit: cover;
        }
        .scene-thumb .placeholder {
            color: #ccc; font-size: 24px;
        }
        .scene-thumb .gen-status {
            position: absolute; bottom: 4px; right: 4px;
            background: #111; color: #fff; border-radius: 4px;
            padding: 1px 6px; font-size: 10px; font-weight: 600;
        }
        .scene-thumb .gen-loading {
            background: #f0f0f0;
            animation: shimmer 1.5s ease-in-out infinite;
        }
        @keyframes shimmer {
            0% { opacity: 0.6; }
            50% { opacity: 1; }
            100% { opacity: 0.6; }
        }
        .scene-body { flex: 1; min-width: 0; }
        .scene-number { font-size: 11px; color: #999; font-weight: 600; text-transform: uppercase; letter-spacing: 0.04em; }
        .scene-title { font-size: 14px; font-weight: 600; margin: 2px 0 4px; }
        .scene-desc { font-size: 13px; color: #555; line-height: 1.5; }
        .scene-narration { font-size: 12px; color: #888; font-style: italic; margin-top: 6px; border-left: 2px solid #eee; padding-left: 10px; }
        .scene-actions { display: flex; gap: 6px; margin-top: 10px; }

        @media (max-width: 640px) {
            .scene-card { flex-direction: column; }
            .scene-thumb { width: 100%; height: 160px; }
        }

        /* Top bar for storyboard */
        .storyboard-header {
            display: flex; justify-content: space-between; align-items: center;
            margin-bottom: 20px; flex-wrap: wrap; gap: 10px;
        }
        .storyboard-meta h2 { margin-bottom: 2px; }
        .storyboard-meta .info { font-size: 13px; color: #888; }
        .storyboard-tools { display: flex; gap: 8px; }

        /* Progress bar thin */
        .gen-progress {
            height: 3px; background: #eee; border-radius: 2px;
            margin-bottom: 24px; overflow: hidden;
        }
        .gen-progress-fill {
            height: 100%; background: #111; border-radius: 2px;
            transition: width 0.5s ease;
        }

        /* Export cards */
        .export-grid {
            display: grid; grid-template-columns: 1fr 1fr;
            gap: 12px; margin-bottom: 32px;
        }
        @media (max-width: 500px) { .export-grid { grid-template-columns: 1fr; } }
        .export-card {
            border: 2px solid #e5e5e5; border-radius: 12px;
            padding: 20px; cursor: pointer; transition: all 0.15s;
            display: flex; gap: 14px; align-items: flex-start;
        }
        .export-card:hover { border-color: #111; }
        .export-card.popular { border-color: #111; }
        .export-icon { font-size: 28px; flex-shrink: 0; }
        .export-name { font-size: 14px; font-weight: 600; }
        .export-desc { font-size: 12px; color: #888; margin-top: 2px; }
        .export-badge {
            display: inline-block; font-size: 10px; font-weight: 600;
            background: #111; color: #fff; padding: 2px 8px;
            border-radius: 4px; margin-top: 4px;
        }

        /* Share section */
        .share-section {
            border-top: 1px solid #eee; padding-top: 24px; margin-top: 8px;
        }
        .share-row {
            display: flex; gap: 8px; align-items: center;
            max-width: 500px;
        }
        .share-row input { flex: 1; }

        /* Divider */
        hr { border: none; border-top: 1px solid #eee; margin: 32px 0; }

        /* Add entity modal-like */
        .add-entity-form {
            display: none; padding: 12px; background: #f9f9f9;
            border-radius: 8px; border: 1px solid #eee; margin-bottom: 12px;
        }
        .add-entity-form.show { display: block; }
        .add-entity-form .form-row {
            display: flex; gap: 8px; margin-bottom: 8px;
        }
        .add-entity-form input { flex: 1; }

        /* Loading overlay */
        .loading-overlay {
            display: none; position: fixed; inset: 0;
            background: rgba(255,255,255,0.95); z-index: 100;
            flex-direction: column; align-items: center; justify-content: center;
        }
        .loading-overlay.show { display: flex; }
        .loading-spinner {
            width: 40px; height: 40px; border: 3px solid #eee;
            border-top-color: #111; border-radius: 50%;
            animation: spin 0.8s linear infinite; margin-bottom: 16px;
        }
        @keyframes spin { to { transform: rotate(360deg); } }
        .loading-text { font-size: 15px; font-weight: 600; margin-bottom: 4px; }
        .loading-sub { font-size: 13px; color: #888; }

        /* Success */
        .success-icon { font-size: 48px; margin-bottom: 16px; }
    </style>
</head>
<body>

<div class="app">
    <!-- Header -->
    <div class="app-header">
        <div class="logo">Storyboard Maker <span>Beta</span></div>
        <div class="header-right">
            <button class="btn btn-sm btn-secondary" onclick="resetDemo()">Recommencer la demo</button>
            <div class="avatar">GP</div>
        </div>
    </div>

    <!-- Progress bar -->
    <div class="progress-bar" id="progressBar">
        <div class="step-dot active" id="dot1">1</div>
        <div class="step-line" id="line1"></div>
        <div class="step-dot" id="dot2">2</div>
        <div class="step-line" id="line2"></div>
        <div class="step-dot" id="dot3">3</div>
        <div class="step-line" id="line3"></div>
        <div class="step-dot" id="dot4">4</div>
    </div>
    <div class="step-labels">
        <div class="step-label active" id="label1">Type</div>
        <div class="step-label" id="label2">Contenu</div>
        <div class="step-label" id="label3">Storyboard</div>
        <div class="step-label" id="label4">Export</div>
    </div>

    <!-- SCREEN 1: Template -->
    <div class="screen active" id="screen1">
        <h1>Nouvelle formation</h1>
        <p class="subtitle">Quel type de formation creez-vous?</p>

        <div class="template-grid" id="templateGrid">
            <div class="template-card" data-tpl="onboarding">
                <div class="template-icon">üëã</div>
                <div class="template-name">Onboarding</div>
                <div class="template-sub">Accueil employe</div>
            </div>
            <div class="template-card" data-tpl="sst">
                <div class="template-icon">üõ°Ô∏è</div>
                <div class="template-name">Sante securite</div>
                <div class="template-sub">Loi 59</div>
            </div>
            <div class="template-card" data-tpl="harcelement">
                <div class="template-icon">üö´</div>
                <div class="template-name">Harcelement</div>
                <div class="template-sub">Loi 42</div>
            </div>
            <div class="template-card" data-tpl="procedure">
                <div class="template-icon">üìã</div>
                <div class="template-name">Procedure</div>
                <div class="template-sub">Mode d'emploi</div>
            </div>
            <div class="template-card" data-tpl="softskills">
                <div class="template-icon">ü§ù</div>
                <div class="template-name">Soft skills</div>
                <div class="template-sub">Leadership</div>
            </div>
            <div class="template-card" data-tpl="technique">
                <div class="template-icon">‚öôÔ∏è</div>
                <div class="template-name">Technique</div>
                <div class="template-sub">Equipement</div>
            </div>
            <div class="template-card" data-tpl="custom">
                <div class="template-icon">‚ú®</div>
                <div class="template-name">Personnalise</div>
                <div class="template-sub">Libre</div>
            </div>
        </div>

        <div class="btn-row">
            <div></div>
            <button class="btn btn-primary btn-large" id="btnStep1" disabled onclick="goTo(2)">Continuer</button>
        </div>
    </div>

    <!-- SCREEN 2: Content -->
    <div class="screen" id="screen2">
        <h1>Decrivez votre formation</h1>
        <p class="subtitle">L'IA va creer le storyboard automatiquement a partir de ces informations.</p>

        <div class="two-col">
            <div>
                <div class="form-group">
                    <label>Sujet</label>
                    <input type="text" id="inputSubject" placeholder="Ex: Securite alimentaire en restauration" value="Securite alimentaire en restauration">
                </div>
                <div class="form-group">
                    <label>Public cible</label>
                    <select>
                        <option>Nouveaux employes</option>
                        <option>Gestionnaires</option>
                        <option>Tout le personnel</option>
                        <option>Equipe technique</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Description de la formation</label>
                    <textarea id="inputDesc" placeholder="Decrivez le contenu de votre formation en quelques phrases, ou collez le texte complet...">Formation sur les bonnes pratiques d'hygiene en cuisine de restaurant. Couvre le lavage des mains, la temperature de conservation des aliments, le nettoyage des surfaces et la gestion des allergenes. Scenario: un nouveau cuisinier apprend les procedures lors de sa premiere journee.</textarea>
                    <div class="hint">Ou importez un document ci-dessous.</div>
                </div>
                <div class="form-group">
                    <label>Importer un document (optionnel)</label>
                    <div class="upload-zone">üìÑ Glissez un fichier Word, PDF ou PowerPoint</div>
                </div>
            </div>
            <div>
                <div class="form-group">
                    <label>Personnages</label>
                    <div class="entity-list" id="charList">
                        <div class="entity-row">
                            <div class="entity-avatar">üë®‚Äçüç≥</div>
                            <div>
                                <div class="entity-name">Karim</div>
                                <div class="entity-role">Nouveau cuisinier</div>
                            </div>
                            <button class="entity-remove">√ó</button>
                        </div>
                        <div class="entity-row">
                            <div class="entity-avatar">üë©‚Äçüç≥</div>
                            <div>
                                <div class="entity-name">Sara</div>
                                <div class="entity-role">Chef de cuisine</div>
                            </div>
                            <button class="entity-remove">√ó</button>
                        </div>
                    </div>
                    <div class="add-entity-form" id="addCharForm">
                        <div class="form-row">
                            <input type="text" placeholder="Nom">
                            <input type="text" placeholder="Role">
                        </div>
                        <div class="upload-zone" style="padding: 12px; font-size: 12px;">üì∑ Photo (optionnel)</div>
                    </div>
                    <button class="btn btn-secondary btn-sm btn-block" onclick="toggleAdd('addCharForm')">+ Ajouter un personnage</button>
                </div>
                <div class="form-group" style="margin-top: 20px;">
                    <label>Lieux</label>
                    <div class="entity-list" id="locList">
                        <div class="entity-row">
                            <div class="entity-avatar">üç≥</div>
                            <div>
                                <div class="entity-name">Cuisine</div>
                                <div class="entity-role">Cuisine professionnelle</div>
                            </div>
                            <button class="entity-remove">√ó</button>
                        </div>
                    </div>
                    <div class="add-entity-form" id="addLocForm">
                        <div class="form-row">
                            <input type="text" placeholder="Nom du lieu">
                        </div>
                        <div class="upload-zone" style="padding: 12px; font-size: 12px;">üì∑ Photo (optionnel)</div>
                    </div>
                    <button class="btn btn-secondary btn-sm btn-block" onclick="toggleAdd('addLocForm')">+ Ajouter un lieu</button>
                </div>
            </div>
        </div>

        <div class="btn-row">
            <button class="btn btn-secondary" onclick="goTo(1)">‚Üê Retour</button>
            <button class="btn btn-primary btn-large" onclick="generateStoryboard()">Creer mon storyboard</button>
        </div>
    </div>

    <!-- SCREEN 3: Storyboard -->
    <div class="screen" id="screen3">
        <div class="storyboard-header">
            <div class="storyboard-meta">
                <h2 id="storyboardTitle">Securite alimentaire en restauration</h2>
                <div class="info" id="storyboardInfo">8 scenes ‚Äî <span id="genCount">0</span>/8 images generees</div>
            </div>
            <div class="storyboard-tools">
                <button class="btn btn-secondary btn-sm">‚öôÔ∏è Parametres</button>
                <button class="btn btn-secondary btn-sm">üîÑ Tout regenerer</button>
            </div>
        </div>

        <div class="gen-progress">
            <div class="gen-progress-fill" id="genProgressFill" style="width: 0%"></div>
        </div>

        <div class="scene-list" id="sceneList">
            <!-- Populated by JS -->
        </div>

        <div class="btn-row">
            <button class="btn btn-secondary" onclick="goTo(2)">‚Üê Retour</button>
            <button class="btn btn-primary btn-large" id="btnExport" onclick="goTo(4)">Exporter</button>
        </div>
    </div>

    <!-- SCREEN 4: Export -->
    <div class="screen" id="screen4">
        <h1>Exporter votre storyboard</h1>
        <p class="subtitle">8 scenes, 8 images. Choisissez un format.</p>

        <div class="export-grid">
            <div class="export-card">
                <div class="export-icon">üìÑ</div>
                <div>
                    <div class="export-name">PDF Storyboard</div>
                    <div class="export-desc">Grille 3 colonnes, pret pour impression</div>
                </div>
            </div>
            <div class="export-card popular">
                <div class="export-icon">üìä</div>
                <div>
                    <div class="export-name">PowerPoint</div>
                    <div class="export-desc">1 scene par slide, modifiable</div>
                    <div class="export-badge">Le plus demande</div>
                </div>
            </div>
            <div class="export-card">
                <div class="export-icon">üñºÔ∏è</div>
                <div>
                    <div class="export-name">Images ZIP</div>
                    <div class="export-desc">Toutes les images en haute resolution</div>
                </div>
            </div>
            <div class="export-card">
                <div class="export-icon">üìÅ</div>
                <div>
                    <div class="export-name">Projet complet</div>
                    <div class="export-desc">Reimportable dans Storyboard Maker</div>
                </div>
            </div>
        </div>

        <div class="share-section">
            <h2>Partager pour validation</h2>
            <p class="subtitle" style="margin-bottom: 12px;">Envoyez ce lien pour revue par un collegue ou client.</p>
            <div class="share-row">
                <input type="text" value="https://storyboard.guip.ca/share/abc123" readonly>
                <button class="btn btn-primary btn-sm">Copier</button>
            </div>
        </div>

        <div class="btn-row">
            <button class="btn btn-secondary" onclick="goTo(3)">‚Üê Retour</button>
            <button class="btn btn-primary btn-large" onclick="showDone()">Telecharger</button>
        </div>
    </div>
</div>

<!-- Loading overlay -->
<div class="loading-overlay" id="loadingOverlay">
    <div class="loading-spinner"></div>
    <div class="loading-text" id="loadingText">Creation du storyboard...</div>
    <div class="loading-sub" id="loadingSub">L'IA decompose votre texte en scenes</div>
</div>

<script>
    let currentStep = 1;
    let selectedTemplate = null;

    const scenes = [
        { num: 1, title: "Arrivee en cuisine", desc: "Karim arrive pour sa premiere journee. Sara l'accueille dans la cuisine professionnelle et lui montre son poste de travail.", narration: "Narrateur: C'est le premier jour de Karim comme cuisinier au restaurant Le Proven√ßal." },
        { num: 2, title: "Lavage des mains", desc: "Sara demontre la technique de lavage des mains en 6 etapes. Plan rapproche sur les mains sous l'eau savonneuse.", narration: "Sara: La premiere regle, c'est le lavage des mains. Minimum 20 secondes, avec du savon." },
        { num: 3, title: "Controle des temperatures", desc: "Karim apprend a verifier les temperatures du refrigerateur. Sara explique les zones de danger entre 4¬∞C et 60¬∞C.", narration: "Sara: Si un aliment reste dans la zone de danger plus de 2 heures, on le jette." },
        { num: 4, title: "Rangement des aliments", desc: "Vue du refrigerateur organise: viandes en bas, legumes au milieu, produits laitiers en haut. Karim prend des notes.", narration: "Narrateur: Le rangement suit une logique stricte pour eviter la contamination croisee." },
        { num: 5, title: "Nettoyage des surfaces", desc: "Sara montre la procedure de nettoyage en 3 etapes: nettoyer, rincer, desinfecter. Gros plan sur les produits utilises.", narration: "Sara: On nettoie les surfaces entre chaque tache. Pas de raccourci." },
        { num: 6, title: "Gestion des allergenes", desc: "Tableau des 14 allergenes majeurs affiche au mur. Sara pointe chaque categorie et explique les risques.", narration: "Sara: Un client allergique, c'est une urgence medicale potentielle. On ne prend aucun risque." },
        { num: 7, title: "Mise en situation", desc: "Karim prepare un plat en appliquant toutes les regles apprises. Sara observe et corrige en temps reel.", narration: "Narrateur: Karim met en pratique les procedures sous la supervision de Sara." },
        { num: 8, title: "Validation des acquis", desc: "Karim repond a un quiz rapide. Sara valide ses connaissances et lui remet son badge de cuisine.", narration: "Sara: Bienvenue dans l'equipe, Karim. Tu es pret." }
    ];

    // Template selection
    document.getElementById('templateGrid').addEventListener('click', function(e) {
        const card = e.target.closest('.template-card');
        if (!card) return;
        document.querySelectorAll('.template-card').forEach(c => c.classList.remove('selected'));
        card.classList.add('selected');
        selectedTemplate = card.dataset.tpl;
        document.getElementById('btnStep1').disabled = false;
    });

    function toggleAdd(id) {
        document.getElementById(id).classList.toggle('show');
    }

    function goTo(step) {
        document.getElementById('screen' + currentStep).classList.remove('active');
        document.getElementById('screen' + step).classList.add('active');
        currentStep = step;
        updateProgress();
        window.scrollTo(0, 0);
    }

    function updateProgress() {
        for (let i = 1; i <= 4; i++) {
            const dot = document.getElementById('dot' + i);
            const label = document.getElementById('label' + i);
            dot.className = 'step-dot';
            label.className = 'step-label';
            if (i < currentStep) {
                dot.classList.add('done');
                dot.textContent = '‚úì';
                label.classList.add('done');
            } else if (i === currentStep) {
                dot.classList.add('active');
                dot.textContent = i;
                label.classList.add('active');
            } else {
                dot.textContent = i;
            }
        }
        for (let i = 1; i <= 3; i++) {
            const line = document.getElementById('line' + i);
            line.className = 'step-line';
            if (i < currentStep) line.classList.add('done');
        }
    }

    function generateStoryboard() {
        const overlay = document.getElementById('loadingOverlay');
        overlay.classList.add('show');

        const steps = [
            { text: "Creation du storyboard...", sub: "L'IA decompose votre texte en scenes", time: 800 },
            { text: "Analyse du scenario...", sub: "Identification des personnages et lieux", time: 1000 },
            { text: "Generation des scenes...", sub: "8 scenes detectees", time: 800 },
            { text: "Generation des images...", sub: "Les images se generent en arriere-plan", time: 600 }
        ];

        let i = 0;
        function nextLoadingStep() {
            if (i < steps.length) {
                document.getElementById('loadingText').textContent = steps[i].text;
                document.getElementById('loadingSub').textContent = steps[i].sub;
                i++;
                setTimeout(nextLoadingStep, steps[i-1].time);
            } else {
                overlay.classList.remove('show');
                goTo(3);
                populateScenes();
                animateGeneration();
            }
        }
        nextLoadingStep();
    }

    function populateScenes() {
        const list = document.getElementById('sceneList');
        list.innerHTML = '';
        scenes.forEach(s => {
            const card = document.createElement('div');
            card.className = 'scene-card';
            card.id = 'scene-' + s.num;
            card.innerHTML = `
                <div class="scene-thumb">
                    <div class="placeholder" id="thumb-${s.num}">‚è≥</div>
                </div>
                <div class="scene-body">
                    <div class="scene-number">Scene ${s.num} / 8</div>
                    <div class="scene-title">${s.title}</div>
                    <div class="scene-desc">${s.desc}</div>
                    <div class="scene-narration">${s.narration}</div>
                    <div class="scene-actions">
                        <button class="btn btn-secondary btn-sm">üîÑ Regenerer</button>
                        <button class="btn btn-secondary btn-sm">‚úèÔ∏è Modifier</button>
                    </div>
                </div>
            `;
            list.appendChild(card);
        });
    }

    function animateGeneration() {
        let generated = 0;
        const total = scenes.length;

        function genNext() {
            if (generated >= total) return;
            generated++;
            const thumb = document.getElementById('thumb-' + generated);
            if (thumb) {
                // Simulate generated image with a colored placeholder
                const colors = ['#e8dcc8', '#c8d8c8', '#d0d8e8', '#e0d0c0', '#d8d0d8', '#c8d0d8', '#d8d8c8', '#d0c8d0'];
                const icons = ['üç≥', 'üßº', 'üå°Ô∏è', 'ü•ó', 'üßπ', '‚ö†Ô∏è', 'üë®‚Äçüç≥', '‚úÖ'];
                thumb.parentElement.innerHTML = `
                    <div style="width:100%;height:100%;background:${colors[generated-1]};display:flex;align-items:center;justify-content:center;font-size:32px;">${icons[generated-1]}</div>
                    <div class="gen-status">‚úì</div>
                `;
            }
            document.getElementById('genCount').textContent = generated;
            document.getElementById('genProgressFill').style.width = (generated / total * 100) + '%';
            if (generated < total) {
                setTimeout(genNext, 400 + Math.random() * 600);
            }
        }
        setTimeout(genNext, 300);
    }

    function showDone() {
        const overlay = document.getElementById('loadingOverlay');
        overlay.classList.add('show');
        document.getElementById('loadingText').textContent = '‚úÖ Telechargement lance!';
        document.getElementById('loadingSub').textContent = 'Votre storyboard PowerPoint est pret.';
        document.querySelector('.loading-spinner').style.display = 'none';
        setTimeout(() => {
            overlay.classList.remove('show');
            document.querySelector('.loading-spinner').style.display = '';
        }, 2000);
    }

    function resetDemo() {
        selectedTemplate = null;
        document.querySelectorAll('.template-card').forEach(c => c.classList.remove('selected'));
        document.getElementById('btnStep1').disabled = true;
        document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
        document.getElementById('screen1').classList.add('active');
        currentStep = 1;
        updateProgress();
        window.scrollTo(0, 0);
    }
</script>

</body>
</html>